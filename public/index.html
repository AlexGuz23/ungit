<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0 ">
    <link rel="stylesheet/css" type="text/css" href="/styles/normalize.css" />
	<link rel="stylesheet" href="/styles/animate.css"/>
	<link rel="stylesheet/less" type="text/css" href="/styles/styles.less" />
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>
</head>
<body>

<script type="text/html" id="empty">
	<div class='crash'>
		<div class='box'>
			<h1>Nothing</h1>
			This is a temporary empty page.
		</div>
	</div>
</script>

<script type="text/html" id="crash">
	<div class='crash'>
		<div class='box'>
			<h1>Whooops</h1>
			Something went wrong, reload the page to start over.
		</div>
	</div>
</script>

<script type="text/html" id="path">
	<div class="path">

		<div class="titleHeader animated fadeInLeft">
			<img src="images/logo.png" class="logo"><span class='title' data-bind='text: title'></span>
		</div>

		<div class='animated fadeInLeft' data-bind="visible: status() == 'loading'">
			Loading...
		</div>

		<div class='animated fadeInLeft' data-bind="visible: status() == 'cloning'">
			Cloning repository...
		</div>
		
		<div class="uninited" data-bind="visible: status() == 'uninited'">
			<div class="topic">"<span data-bind="text: path"></span>" is not a repository.</div>
			<button class="initRepository" data-bind='click: initRepository'>Initialize a repository here!</button>
			<div class="or"><div class="line"></div>or<div class="line"></div></div>
			<form class="cloneRepository" data-bind="submit: cloneRepository">
				<div>Clone from</div>
				<div><input type="text" placeholder="url" data-bind="value: cloneUrl, valueUpdate: 'afterkeydown'"></div>
				<div>to</div>
				<div><input type="text" data-bind="value: cloneDestination, attr: { placeholder: cloneDestinationImplicit }"></div>
				<div><input type="submit" value="Clone repository!"></div>
			</form>
		</div>

		<div class="invalidpath" data-bind="visible: status() == 'invalidpath'">
			<div>"<span data-bind="text: path"></span>" is not a valid path.</div>
		</div>

		<!-- ko if: repository -->
		<div data-bind="template: { name: 'repository', data: repository }">
		</div>
		<!-- /ko -->

	</div>
</script>

<script type="text/html" id="repository">
	<div class="repository">

		<div class='animated fadeInLeft' data-bind="visible: status() == 'loading'">
			Loading...
		</div>
		
		<div class="inited animated fadeInLeft" data-bind="visible: status() == 'inited'">

			<div class="staging" data-bind="css: { commitValidationError: commitValidationError }">
				<div class="arrowContainer arrowDown">
					<img src="images/shadowArrowDown.png" class="shadow">
					<img src="images/yellowArrowDown.png" class="arrow">
				</div>
				<div data-bind="visible: !isCommitting()">
					<table><tr><td class="commitArea">
						<textarea class="commitMessage" placeholder="Enter a commit message" data-bind="value: commitMessage, valueUpdate: 'afterkeydown'"></textarea>
						<div class="files" data-bind="foreach: files">
							<div class="file">
								<div class="checkbox" data-bind="click: toogleStaged, css: { checked: staged }"></div>
								<span class="name" data-bind="text: name, click: toogleDiffs"></span>
								<span class="new" data-bind="visible: isNew">New</span>
								<span class="deleted" data-bind="visible: removed">Removed</span>
								<span class="discard" data-bind="click: discardChanges">&#x2716;<span class="explanation"> discard changes</span></span>
							</div>
						</div>
						<button class="commitButton" data-bind="click: commit, enable: !commitValidationError()">Commit</button>
						<span class="validationError" data-bind="text: commitValidationError, visible: commitValidationError"></span>
					</td><td class="diffArea" data-bind="css: { noFileSelected: !selectedDiffFile() }">
						<!-- ko if: selectedDiffFile -->
						<div class="diffs" data-bind="foreach: selectedDiffFile().diffs">
							<div class="diff" data-bind="text: text, css: { added: added, removed: removed}"></div>
						</div>
						<!-- /ko -->
						<!-- ko if: !selectedDiffFile() -->
						Click a file to show its changes
						<!-- /ko -->
					</td></tr></table>
				</div>
				<div data-bind="visible: isCommitting">
					Committing changes...
				</div>
			</div>

			<div class="graphUtils" data-bind="visible: isFetching">
				<img src="images/grayArrowDown.png" class="arrowDown">
				<div class="fetchingIndicator">Fetching nodes from remote...</div>
			</div>
			
			<div class="graph" data-bind="with: graph">

				<div class="daySeparators" data-bind="foreach: daySeparators">
					<div class="daySeparator" data-bind="style: { left: x + 'px', top: y + 'px' }">
						<img src="images/whiteArrowRight.png" class="arrowRight">
						<div class="dateLabel" data-bind="text: date"></div>
					</div>
				</div>

				<div class="graphLog" data-bind="graphLog: $data">
				</div>
				
				<div class="nodes" data-bind="foreach: nodes">
					<div class="node" data-bind="style: { left: boxDisplayX() + 'px', top: boxDisplayY() + 'px' }">
						<div class="log" data-bind="visible: logBoxVisible">
							<div class="logEntryBox">
								<div class="arrowContainer arrowRight">
									<img src="images/shadowArrowRight.png" class="shadow">
									<img src="images/whiteArrowRight.png" class="arrow">
								</div>
								<div class="title" data-bind="text: title"></div>
								<div class="date" data-bind="text: authorDate"></div>
								<a class="author" data-bind="text: authorName, attr: { href: 'mailto:' + authorEmail }"></a>
							</div>
						</div>

						<div class="refs">
							<div class="refsList" data-bind="foreach: branches">
								<div class="refbox" data-bind="css: { current: current, remote: isRemoteBranch }, dragStart: dragStart, dragEnd: dragEnd" draggable="true">
									<img src="images/grayArrowLeft.png" class="arrowLeft" data-bind="visible: $index() == 0">
									<div class="name" data-bind="text: displayName, click: checkout"></div>
									<span data-bind="visible: isRemoteBranch">(remote)</span>
								</div>
								<span data-bind="visible: current">
									<div class="refbox push" data-bind="click: push, visible: pushVisible, event: { mouseover: mouseoverPush, mouseout: mouseoutPush }">
										&#11014;
										<span class="tooltip">Push changes to remote</span>
									</div>
									<div class="refbox reset" data-bind="click: reset, visible: resetVisible, event: { mouseover: mouseoverReset, mouseout: mouseoutReset }">
										&#11015;
										<span class="tooltip">Reset to remote</span>
									</div>
									<div class="refbox rebase" data-bind="click: rebase, visible: rebaseVisible, event: { mouseover: mouseoverRebase, mouseout: mouseoutRebase }">
										&#10145;
										<span class="tooltip">Rebase on remote</span>
									</div>
								</span>
							</div>
							
							<span data-bind="visible: showDropTargets">
								<div class="refbox move" data-bind="dropOver: true, drop: dropMoveRef">Move here</div>
							</span>

							<div class="refbox newRef">
								<img src="images/grayArrowLeft.png" class="arrowLeft" data-bind="visible: branches().length == 0">
								<form data-bind="submit: createBranch">
									<input class="name" type="text" placeholder="&#x271A;" data-bind="value: newBranchName">
									<input class="submit" type="submit">
								</form>
							</div>
						</div>

					</div>
				</div>

			</div>

		</div>
	</div>
</script>


<script type="text/html" id="pushDialog">
	<div class="pushDialog">
		<div class="status">Pushing changes to remote...</div>
		<form data-bind="submit: submitCredentials, visible: showCredentialsForm">
		<div>Remote requires authentication</div>
		<div>Username: <input type="text" data-bind="value: username" autofocus></div>
		<div>Password: <input type="password" data-bind="value: password"></div>
		<div><input type="submit"></div>
		</form>
	</div>
</script>

<div class="main">

	<div class="currentDirectory">
		<form data-bind="submit: submitPath">
			<input type="text" data-bind="value: path">
		</form>
	</div>

	<div class="content" data-bind="template: { name: templateChooser, data: content }"></div>

</div>

<!-- ko if: dialog -->
<div class="dialog animated fadeIn">
	<div class="modalContainer">
		<div class="modal" data-bind="template: { name: templateChooser, data: dialog }"></div>
	</div>
</div>
<!-- /ko -->


<script type="text/javascript" src="/scripts/lib/less-1.3.3.min.js"></script>
<script type='text/javascript' src='/scripts/lib/knockout-2.2.1.js'></script>
<script type="text/javascript" src="/scripts/lib/jquery-2.0.0.min.js"></script>
<script type="text/javascript" src="/scripts/lib/google.ui.fastbutton.js"></script>
<script type="text/javascript" src="/scripts/lib/superagent.js"></script>
<script type="text/javascript" src="/scripts/lib/signals.js"></script>
<script type="text/javascript" src="/scripts/lib/hasher.js"></script>
<script type="text/javascript" src="/scripts/lib/crossroads.js"></script>
<script type="text/javascript" src="/scripts/lib/uuid.js"></script>
<script type="text/javascript" src="/scripts/lib/moment.js"></script>
<script type="text/javascript" src="/scripts/lib/underscore.js"></script>
<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type='text/javascript' src='/scripts/api.js'></script>
<script type='text/javascript' src='/scripts/gitGraph.js'></script>
<script type='text/javascript' src='/scripts/vector2.js'></script>
<script type='text/javascript' src='/scripts/logrenderer.js'></script>
<script type='text/javascript' src='/scripts/app.js'></script>
<script type='text/javascript' src='/scripts/main.js'></script>

</body>
</html>